<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#0a1628">
    <title>Card Builder - Strategic Card Game</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/builder.css">
    <link rel="stylesheet" href="css/mobile.css">
</head>
<body class="card-builder-page">
    <div class="builder-container">
        <!-- Navigation -->
        <nav class="nav-bar">
            <div class="nav-links">
                <a href="/">Play</a>
                <a href="/card-builder.html" class="active">Card Builder</a>
                <a href="/deck-builder.html">Deck Builder</a>
            </div>
            <div class="user-info">
                <span id="username-display"></span>
                <button class="btn-logout" onclick="Auth.logout()">Logout</button>
            </div>
        </nav>

        <!-- Main Builder Area -->
        <div class="builder-main">
            <!-- Traits Panel (Left) -->
            <div class="panel traits-panel" id="panel-traits">
                <div class="panel-header">
                    <h2>Traits</h2>
                </div>
                <div class="panel-content">
                    <div id="traits-container" class="traits-container">
                        <!-- Trait categories will be rendered here by JS -->
                    </div>
                </div>
            </div>

            <!-- Card Wizard Panel (Center-Left) -->
            <div class="panel wizard-panel" id="panel-wizard">
                <div class="panel-header">
                    <h2>Card Wizard</h2>
                    <button class="btn btn-secondary btn-sm" onclick="toggleWizard()">
                        <span id="wizard-toggle-text">Hide</span>
                    </button>
                </div>
                <div id="wizard-content" class="wizard-content">
                    <p class="wizard-intro">Build your perfect card step by step!</p>

                    <!-- Step 1: Role -->
                    <div class="wizard-step" data-step="1">
                        <div class="wizard-step-header">
                            <span class="step-number">1</span>
                            <span class="step-title">What role should this card fill?</span>
                        </div>
                        <div class="wizard-options" id="wizard-role">
                            <button class="wizard-option" data-value="tank" onclick="selectWizardOption('role', 'tank', this)">
                                <span class="option-icon">ÔøΩÔøΩÔ∏è</span>
                                <span class="option-label">Tank</span>
                                <span class="option-desc">High health, protects allies</span>
                            </button>
                            <button class="wizard-option" data-value="damage" onclick="selectWizardOption('role', 'damage', this)">
                                <span class="option-icon">‚öîÔ∏è</span>
                                <span class="option-label">Damage</span>
                                <span class="option-desc">High attack, kills enemies</span>
                            </button>
                            <button class="wizard-option" data-value="support" onclick="selectWizardOption('role', 'support', this)">
                                <span class="option-icon">‚ú®</span>
                                <span class="option-label">Support</span>
                                <span class="option-desc">Buffs allies, utility effects</span>
                            </button>
                            <button class="wizard-option" data-value="assassin" onclick="selectWizardOption('role', 'assassin', this)">
                                <span class="option-icon">üó°Ô∏è</span>
                                <span class="option-label">Assassin</span>
                                <span class="option-desc">Fast, high burst damage</span>
                            </button>
                        </div>
                    </div>

                    <!-- Step 2: Playstyle -->
                    <div class="wizard-step" data-step="2">
                        <div class="wizard-step-header">
                            <span class="step-number">2</span>
                            <span class="step-title">How should it play?</span>
                        </div>
                        <div class="wizard-options" id="wizard-playstyle">
                            <button class="wizard-option" data-value="aggressive" onclick="selectWizardOption('playstyle', 'aggressive', this)">
                                <span class="option-icon">üî•</span>
                                <span class="option-label">Aggressive</span>
                                <span class="option-desc">Attack immediately, high tempo</span>
                            </button>
                            <button class="wizard-option" data-value="defensive" onclick="selectWizardOption('playstyle', 'defensive', this)">
                                <span class="option-icon">üè∞</span>
                                <span class="option-label">Defensive</span>
                                <span class="option-desc">Survive, protect, outlast</span>
                            </button>
                            <button class="wizard-option" data-value="tricky" onclick="selectWizardOption('playstyle', 'tricky', this)">
                                <span class="option-icon">üé≠</span>
                                <span class="option-label">Tricky</span>
                                <span class="option-desc">Evasion, stealth, deception</span>
                            </button>
                            <button class="wizard-option" data-value="value" onclick="selectWizardOption('playstyle', 'value', this)">
                                <span class="option-icon">üíé</span>
                                <span class="option-label">Value</span>
                                <span class="option-desc">Efficient, sustain, grind</span>
                            </button>
                        </div>
                    </div>

                    <!-- Step 3: Cost Preference -->
                    <div class="wizard-step" data-step="3">
                        <div class="wizard-step-header">
                            <span class="step-number">3</span>
                            <span class="step-title">Mana cost preference?</span>
                        </div>
                        <div class="wizard-options" id="wizard-cost">
                            <button class="wizard-option" data-value="cheap" onclick="selectWizardOption('cost', 'cheap', this)">
                                <span class="option-icon">üí®</span>
                                <span class="option-label">Cheap (0-2)</span>
                                <span class="option-desc">Play early, swarm potential</span>
                            </button>
                            <button class="wizard-option" data-value="medium" onclick="selectWizardOption('cost', 'medium', this)">
                                <span class="option-icon">‚öñÔ∏è</span>
                                <span class="option-label">Medium (3-5)</span>
                                <span class="option-desc">Balanced, flexible</span>
                            </button>
                            <button class="wizard-option" data-value="expensive" onclick="selectWizardOption('cost', 'expensive', this)">
                                <span class="option-icon">üëë</span>
                                <span class="option-label">Expensive (6+)</span>
                                <span class="option-desc">Powerful finisher</span>
                            </button>
                        </div>
                    </div>

                    <!-- Step 4: Risk Tolerance -->
                    <div class="wizard-step" data-step="4">
                        <div class="wizard-step-header">
                            <span class="step-number">4</span>
                            <span class="step-title">Risk tolerance?</span>
                        </div>
                        <div class="wizard-options" id="wizard-risk">
                            <button class="wizard-option" data-value="safe" onclick="selectWizardOption('risk', 'safe', this)">
                                <span class="option-icon">üîí</span>
                                <span class="option-label">Safe</span>
                                <span class="option-desc">No downsides, reliable</span>
                            </button>
                            <button class="wizard-option" data-value="moderate" onclick="selectWizardOption('risk', 'moderate', this)">
                                <span class="option-icon">üé≤</span>
                                <span class="option-label">Moderate</span>
                                <span class="option-desc">Minor drawbacks for power</span>
                            </button>
                            <button class="wizard-option" data-value="risky" onclick="selectWizardOption('risk', 'risky', this)">
                                <span class="option-icon">üíÄ</span>
                                <span class="option-label">High Risk</span>
                                <span class="option-desc">Big drawbacks, big rewards</span>
                            </button>
                        </div>
                    </div>

                    <!-- Generate Button -->
                    <div class="wizard-actions">
                        <button class="btn btn-primary btn-lg" onclick="generateFromWizard()" id="wizard-generate-btn" disabled>
                            ‚ú® Generate Card
                        </button>
                        <button class="btn btn-secondary" onclick="resetWizard()">
                            Reset Choices
                        </button>
                    </div>

                    <!-- Wizard Summary -->
                    <div id="wizard-summary" class="wizard-summary hidden">
                        <h4>Your Build:</h4>
                        <div id="wizard-summary-content"></div>
                    </div>
                </div>
            </div>

            <!-- Card Preview Panel (Center) -->
            <div class="panel card-preview-panel" id="panel-editor">
                <div class="panel-header">
                    <h2>Card Editor</h2>
                    <div class="panel-header-buttons">
                        <button class="btn btn-action" onclick="randomizeCard()">Randomize</button>
                        <button class="btn btn-secondary" onclick="resetCard()">Reset</button>
                    </div>
                </div>

                <!-- Points Display -->
                <div class="points-display">
                    <div class="points-label">Points Remaining</div>
                    <div id="points-value" class="points-value">10</div>
                </div>

                <!-- Card Preview -->
                <div class="card-preview-large" style="position: relative;">
                    <div id="card-mana-display" class="card-cost">2</div>

                    <!-- Sprite Icon -->
                    <div id="card-sprite-display" class="card-sprite">
                        <span class="sprite-icon">?</span>
                    </div>

                    <input type="text" id="card-name" class="card-name-input"
                           placeholder="Card Name" maxlength="20">

                    <!-- Active Traits -->
                    <div id="active-traits" class="active-traits">
                        <span class="empty-traits-hint">Tap traits to add (max 3)</span>
                    </div>

                    <div class="card-stats-row">
                        <span class="card-stat attack">&#9876; <span id="attack-display">1</span></span>
                        <span class="card-stat health">&#9829; <span id="health-display">1</span></span>
                    </div>
                </div>

                <!-- Sprite Selection -->
                <div class="sprite-selector">
                    <h3>Choose Icon</h3>
                    <div id="sprite-grid" class="sprite-grid">
                        <!-- Sprites will be rendered here -->
                    </div>
                </div>

                <!-- Stat Sliders -->
                <div class="stat-controls">
                    <div class="stat-control">
                        <span class="stat-label">Attack</span>
                        <input type="range" id="attack-slider" min="0" max="15" value="1">
                        <span id="attack-value" class="stat-value">1</span>
                    </div>
                    <div class="stat-control">
                        <span class="stat-label">Health</span>
                        <input type="range" id="health-slider" min="1" max="20" value="1">
                        <span id="health-value" class="stat-value">1</span>
                    </div>
                    <div class="stat-control">
                        <span class="stat-label">Mana Cost</span>
                        <input type="range" id="mana-slider" min="0" max="12" value="2">
                        <span id="mana-value" class="stat-value">2</span>
                    </div>
                </div>

                <!-- Actions -->
                <div class="card-actions">
                    <button id="save-card-btn" class="btn btn-primary" onclick="saveCard()">Save Card</button>
                    <button id="delete-card-btn" class="btn btn-secondary" onclick="deleteCard()" style="display: none;">Delete</button>
                </div>

                <div id="card-error" class="error-message hidden"></div>
            </div>

            <!-- My Cards Panel (Right) -->
            <div class="panel" id="panel-cards">
                <div class="panel-header">
                    <h2>My Cards</h2>
                    <span id="card-count">0 cards</span>
                </div>
                <div class="panel-content">
                    <div id="my-cards" class="cards-grid"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/auth.js"></script>
    <script src="js/cardBuilder.js"></script>
</body>
</html>
